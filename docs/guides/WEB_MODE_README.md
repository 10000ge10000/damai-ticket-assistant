# 网页模式零基础上手指南

本指南帮助你从零开始配置并使用本项目的网页模式，实现基于浏览器的自动抢票流程。推荐新手按照顺序逐节阅读并完成操作。

---

## 1. 环境准备

### 1.1 必备软件

- **Python 3.9 及以上版本**（安装时勾选 *Add Python to PATH*）
- **Google Chrome 浏览器**（建议保持最新稳定版；Selenium Manager 会自动管理 ChromeDriver，无需手动安装）

### 1.2 安装依赖

1. 打开命令行，切换到项目根目录。
2. 执行以下命令自动安装依赖：

    ```powershell
    pip install -r requirements.txt
    ```

> 若使用 `scripts/windows/start_gui.bat`，脚本会自动检测并安装缺失依赖，无需手动处理。

### 1.3 可选工具

- **Node.js + Appium CLI**：仅在需要一站式安装脚本或后续切换到 App 模式时使用。
- **Android Platform Tools**：与网页模式无直接关联，可按需忽略。

---

## 2. 启动与登录

### 2.1 启动 GUI

- 推荐新手运行 `scripts/windows/start_gui.bat`，脚本会完成环境检测与 GUI 启动。
- 若需查看详细日志，使用 `scripts/windows/debug_gui.bat`。
- 环境已就绪的高级用户可以直接双击 `start_gui.pyw` 快速进入 GUI。

### 2.2 登录大麦账号

1. 在 GUI 中选择“网页模式（Web）”。
2. 点击“网页登录”进入浏览器窗口。
3. 通过二维码或账号密码登录。
4. 登录成功后，工具会自动保存 Cookie，后续启动可免重复登录。

> 如需切换/清除账户，可在 GUI 的登录管理区域执行“清除 Cookie”。

---

## 3. 页面分析与参数配置

### 3.1 获取演出链接

- 打开大麦网官网，找到目标演出，复制页面 URL。
- 确认链接可直接访问演出详情页（非分享短链）。

### 3.2 填写页面链接

1. 在 GUI 的“页面分析”区域粘贴演出链接。
2. 点击“分析页面”。
3. 等待工具完成解析，界面会展示可选的城市、场次、票档、数量等参数。

### 3.3 设置抢票参数

- **城市 / 场次**：选择你实际计划观看的区域和时间。
- **票档/价格**：可多选；工具会按顺序尝试可用票档。
- **数量**：输入需要抢购的票数。注意部分场次可能限制购票数量。
- **观演人**：在“观演人管理”中勾选大麦账号下已实名的观演人。
- **自动提交订单**（可选）：开启后将在成功选票后自动提交，请务必确认观演人信息和地址无误。

> 参数设置完成后，系统会即时校验是否缺少必要字段，如有提示请按指引补全。

---

## 4. 执行抢票

1. 检查“运行日志”面板，确认当前无红色错误信息。
2. 点击“开始抢票”按钮。
3. 工具会按照以下流程自动执行：
   - 打开 Chrome 浏览器并加载目标演出页面
   - 按顺序尝试可选票档与场次
   - 自动勾选观演人并填写订单信息
   - 根据设置决定是否自动提交
4. 抢票过程中，可实时在“运行日志”面板看到每个步骤的状态与耗时。
5. 如需中断，可随时点击“停止抢票”。

> 若页面结构与历史版本差异较大，可能触发“未识别按钮”提示，可尝试更新至最新代码或反馈 Issue。

---

## 5. 常见问题排查

| 问题 | 可能原因 | 解决建议 |
| --- | --- | --- |
| 浏览器无法自动弹出 | Chrome/ChromeDriver 版本不一致 | 更新 Chrome 或下载匹配版本的 ChromeDriver |
| 页面分析失败 | 链接为空或访问受限 | 确认链接可在浏览器直接打开，并保持登录状态 |
| 登录后仍提示未登录 | Cookie 失效或被清除 | 重新执行网页登录，确保关闭窗口前已完成登录 |
| 观演人列表为空 | 账号未完成实名或未勾选 | 登录大麦官网完善观演人信息后重新分析 |
| 自动提交失败 | 支付方式/验证码步骤需人工参与 | 将“自动提交订单”关闭，改为手动确认 |

更多案例和排查经验欢迎在 Issues 中提交分享。

---

## 6. 进阶用法

- **脚本模式**：若偏好命令行，可参阅 `damai/` 目录下的脚本，自行编写批处理或定时任务。
- **多场次尝试**：在参数配置阶段多选多个场次，系统会按照配置顺序自动尝试。
- **日志导出**：结束后点击“导出日志”按钮，可生成包含运行摘要与详细步骤的 JSON 文件，方便复盘。

---

## 7. CLI/脚本化操作（规划中）

- 我们将补充网页模式的命令行快速启动示例（如 `python -m damai.concert`）以及常用参数说明，方便无 GUI 场景使用。
- 计划提供 Windows PowerShell 与跨平台 Bash 样例脚本，便于定时任务或批量执行。
- 欢迎在 Issue 中反馈需求场景，便于在指南发布时涵盖更多实战案例。

---

## 8. 下一步

- 想体验移动端极速抢票？阅读 [App 模式零基础上手指南](APP_MODE_README.md)。
- 想了解未来功能规划？查看主仓库 `README.md` 中的“扩展路线”。
- 使用过程中有疑问？欢迎提交 Issue 或在讨论区交流。

祝你抢票顺利！🎫
